select (n, d, v)
from r in source(xml, "sample_xml/hcn_sensors.xml", {"data"}),
    d in r.date,
    v in r.value,
    t in source(xml, "sample_xml/hcn_stations.xml", {"station"}),
    n in t.displayName,
    l in t.locationLabels
where text(t.id) = text(r.station) 
    and toInt(substring(text(d), 0, 4)) = 2000
    and text(r.dataType) = "TMAX"
    and text(l.displayName) = "WASHINGTON"
;