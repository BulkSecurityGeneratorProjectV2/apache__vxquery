select (n, d, v)
from sensors in source(xml, "sample_xml/nano_sensors.xml", {"data"}),
    d in sensors.date,
    v in sensors.value,
    stations in source(xml, "sample_xml/nano_stations.xml", {"station"}),
    n in stations.displayName,
    l in stations.locationLabels
where text(stations.id) = text(sensors.station) 
    and toInt(substring(text(d), 0, 4)) = 2002
    and text(sensors.dataType) = "TMAX"
;